<!DOCTYPE html>
<html>

<head>
    <style>
        body {
            margin: 0;
            overflow: hidden;
        }
    </style>
</head>

<body>
    <script src="js/three.min.js"></script>
    <script src="js/mannequin.js"></script>
    <script src="js/orbitcontrols.js"></script>

    <script>
        let scene, camera, renderer, controls, man;
        let postureIndex = 0; // Index of current posture
        let postures = []; // Array to hold multiple postures

/*         // Define postures
        const A = { "version": 7, "data": [[-1, 3.8, -67.1], [0, 89.8, 0], [0.5, -1.6, 18.7], [0, 0, -18.7], [6, 0, 0], [0], [-6, -6, -0.6], [-6, 0, 0], [0], [6, 6, -0.6], [7, -0.6, -5], [15], [5, 0, 0], [-90, 70, 75, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [-15.3, -79.4, 163.9], [0.1], [-5, 0, 0], [90, -70, 75, 0, 10, 0, 89.9], [0, 0, 94.7, 0, 80.6, 0, 40.9], [0, 0, -10, 0, 10, 0, 10], [0, 0, 119.9, 0, 10, 0, 22.1], [0, 0, 119.9, 0, 10, 0, 54.1]] };
        const B = { "version": 7, "data": [[0.1, -0.9, 0], [7.3, -90, 0], [0, 0, -14.3], [0, 0, -1.1], [6, 0, 52.7], [64.1], [-6, -6, -20.3], [-6, 0, 33.2], [51.2], [6, 6, -32.2], [26.4, 3.2, 5], [113.2], [64.9, -48.2, 55.3], [-90, 70, 75, 0, 10, 0, 10], [0, 0, 37, 0, 4.6, 0, 10], [-0.7, -1.5, 65.9, 0, 10, 0, 10], [9.2, 6.2, 33.8, 0, 14, 0, 47.2], [3.8, 4.9, 51.9, 0, 25.3, 0, 10], [-7, 0.6, -5], [79.1], [-27, 0, 0], [90, -70, 75, 0, 10, 0, 10], [0, 0, 10, 0, 51.7, 0, 10], [0, 0, 10, 0, 10, 0, 39.4], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10]] };
        const C = { "version": 7, "data": [[0.1, -0.9, 0], [7.3, -90, 0], [0, 0, -14.3], [0, 0, 17.6], [6, 0, 52.7], [64.1], [-6, -6, -20.3], [-6, 0, 33.2], [51.2], [6, 6, -32.2], [26.4, 3.2, 5], [31.8], [64.9, -48.2, 55.3], [-90, 70, 75, 0, 10, 0, 10], [0, 0, 37, 0, 4.6, 0, 10], [-0.7, -1.5, 65.9, 0, 10, 0, 10], [9.2, 6.2, 33.8, 0, 14, 0, 47.2], [3.8, 4.9, 51.9, 0, 25.3, 0, 10], [-7, 0.6, -5], [79.1], [-27, 0, 0], [90, -70, 75, 0, 10, 0, 10], [0, 0, 10, 0, 51.7, 0, 10], [0, 0, 10, 0, 10, 0, 39.4], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10]] };
        const D = { "version": 7, "data": [[0, 0, 0], [180, -88.6, 180], [11.8, 5.5, -1.8], [-12.7, -1.3, 0.2], [-8.6, 41.3, 124], [43.7], [-6, -6, -9.5], [7.3, -31.6, 74.8], [48.8], [-23.2, -5.5, 21.1], [63.6, 44.2, -3.4], [88.5], [-56.3, 0, 0], [-90, 70, 75, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [89.7, -85, -156.7], [56.6], [15, 0, 0], [-90, 70, 75, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10], [0, 0, 10, 0, 10, 0, 10]] }; */

        //1. ER MATTO

        const A = {"version":7,"data":[[0,0,0],[180,-88.6,180],[11.8,5.5,-1.8],[-12.7,-1.3,0.2],[-8.6,41.3,124],[43.7],[-6,-6,-9.5],[7.3,-31.6,74.8],[48.8],[-23.2,-5.5,21.1],[63.6,44.2,-3.4],[88.5],[-56.3,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[89.7,-85,-156.7],[56.6],[15,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //2. ER MAGO

        const B = {"version":7,"data":[[0,0.3,0],[3.4,-35.7,1.3],[5.4,-6.3,-5.7],[6.1,-25.3,-0.3],[21,0,0],[0],[-6,-6,48.7],[-6.3,-26.1,5.1],[9.6],[1.3,6,-0.1],[28.3,-2.4,-33.1],[71.4],[-2.2,-23.1,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-47.4,-77.8,67.8],[6.6],[1.1,0,-54.3],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //3. ER EMITA

        const C = {"version":7,"data":[[0,-0.3,0],[7.5,-1.2,0],[1.4,6.1,-30.6],[4.5,-2.7,15.9],[5.8,10.2,1.4],[16.4],[-6,-6,-4.5],[-4.9,-3.8,22.5],[18.4],[6,6,3],[27.1,9.5,115],[51.5],[-17.8,11.1,-71.8],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-14.5,-2.7,14.9],[51.9],[-58.1,-65.7,-41.9],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //4. ER FORZA

        const D = {"version":7,"data":[[0,-1.5,0],[0,-90,0],[0,0,-2],[0,0,5],[10.3,12.3,6.3],[41.6],[-14.2,-3.7,-15.9],[-6,-34.6,16.8],[38.8],[6,6,-16.3],[89.6,85.6,14.5],[103.7],[75,-19,90],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-89.7,-85,13.6],[104.8],[-75,21.1,90],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //5. ER MORTO

        const E = {"version":7,"data":[[0,-28.7,0],[-90.4,-90,0],[12.7,-0.4,-2],[-7.5,-28.5,11.5],[6,0,-2.5],[0],[-6,-6,15.6],[-21,-29.4,-3],[0],[6,6,16.6],[24,52.5,-14.9],[15],[-11.9,-19.5,9.3],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-24.3,-23.3,-11.7],[14.1],[15,32.4,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //6. ER GIUDIZIOSO (1)

        const F = {"version":7,"data":[[0,-0.3,0],[-83.7,-84.7,-90],[7.7,1.8,13.4],[-2.9,0,0.4],[5,14.2,13.9],[11.6],[-6,-6,-5.7],[2.1,-1.3,10.3],[11.9],[6,6,-4.1],[39.3,-71.2,45.4],[102.4],[18.6,3.3,0.4],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-89.8,65.4,86.8],[103.3],[-89.9,22.2,27.2],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //6. ER GIUDIZIOSO (2)

        const G = {"version":7,"data":[[0,-0.3,0],[-83.7,-84.7,-90],[6.7,-0.4,-36.2],[-2.9,0,25],[12.2,14.8,-4],[11.6],[-6,-6,-5.7],[0.6,-2,-2.9],[11.9],[6,6,-4.1],[39.3,-71.2,-11.7],[102.4],[18.6,3.3,0.4],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-89.7,77.3,36.2],[95],[7,-4.4,38.3],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //7. ER TORRE

        const H = {"version":7,"data":[[0,0,0],[0,-90,0],[-12.2,0.4,-2],[-3.5,-0.3,5],[-5.5,0,0],[0],[2,-6,0.2],[-2.5,0,0],[0],[-2.5,6,0.3],[11.8,-1,2.1],[0.1],[-3.1,-41.9,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-3.9,2.2,4.5],[0],[-1.5,33,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //8. ER ROTA

        const I = {"version":7,"data":[[0,-5.58,0],[-0.3,-5.2,78.8],[0,0,36.7],[0,0,30],[16.3,-3.5,-28.3],[52.4],[-6,-6,-0.2],[-16.1,2.6,-28.8],[48.5],[6,6,3.2],[-46.9,26.1,-135.1],[26.5],[-104.5,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[30,-10.7,-139.8],[27.7],[97.5,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //9. ER STELLA

        const J = {"version":7,"data":[[0,0.61,0],[62.4,-84.6,44.1],[-2.8,-6.8,24.6],[-0.3,2.6,-7.7],[23.9,-1.2,28.6],[0],[-7.9,4.7,63.9],[-32.4,-0.9,18.6],[0],[-0.3,8.6,59.2],[89.9,77.7,39.3],[0.7],[-15,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-89.9,-74.9,38.1],[0],[15,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //10. ER MONNO

        const K = {"version":7,"data":[[0,0.58,0],[62.4,-84.6,44.1],[-2.8,-6.8,24.6],[-0.3,2.6,-7.7],[2.7,-12.2,16],[0],[-1.5,-30.7,10.9],[-16.3,7.1,17.9],[0],[-3.3,28.9,8.6],[89.9,77.7,63.4],[84.3],[-79.2,-47.8,-78.9],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-89.9,-74.9,70.2],[78.3],[-70.8,-41.2,-90],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //11. ER PAPA

        const L = {"version":7,"data":[[0,-15.48,0],[0,-90,0],[0,0,-2],[0,0,5],[1.1,7.9,88.9],[77.7],[-6,-6,-0.6],[-2.2,-7.7,88.5],[73.3],[6,6,-0.6],[2.9,-39.7,-6.5],[89.6],[56.4,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-23,7.5,43.5],[99.8],[30.5,-65.1,33.2],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //12. ER PAPESSA

        const M = {"version":7,"data":[[0,-15.48,0],[0,-90,0],[0,0,-2],[0,0,5],[-50.3,-23.6,91.4],[105.2],[-6,-6,-0.6],[-1.7,9.6,88.5],[73.3],[6,6,-0.6],[2.9,-39.7,-6.5],[89.6],[56.4,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-23,7.5,43.5],[99.8],[30.5,-65.1,33.2],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //13. ER SOLE (1)

        const N = {"version":7,"data":[[0,0.72,0],[0,-90,0],[0,0,13.7],[0,0.1,15.4],[9.3,9.3,2.4],[0.6],[-6.3,-6.4,12.3],[-9.9,-0.9,6.1],[11.6],[0.1,5,8.6],[38.2,68.9,94.3],[43.5],[-92.2,-0.6,6.2],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-36.2,-69.4,90.2],[46.2],[92.6,1.7,14.4],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //14. ER CARRO

        const O = {"version":7,"data":[[0,-32.6,0],[-0.7,-28,-95.7],[0,0,43.8],[0,0,25],[10.1,-8.4,-27.3],[95.5],[-6,-6,48.6],[-13.1,7.6,-27.1],[95.8],[6,6,38.9],[7,-0.6,-58.5],[-0.5],[-15,5.4,-5.3],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-7,0.6,-59.9],[0],[15,-4.4,-7.6],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //15. ER CUPIDO (1)

        const P = {"version":7,"data":[[0,6.6,0],[12.4,-80.6,-42.5],[-9.8,-15.6,22.3],[-10.6,21.9,2.3],[-12.2,18.4,10.8],[48.8],[-6,-6,51.3],[-7.8,-30.7,-10.2],[67.3],[6,6,42.7],[40.5,27.1,75.4],[1.1],[-10.2,0,0],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-90,-24.3,-19.4],[116.3],[-11.1,-28.7,-6.9],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //16. ER CUPIDO (zoom su mani/petto)

        const Q = {"version":7,"data":[[0,0,0],[0,-90,0],[0,0,-2.4],[0,0,5],[-6.4,0.2,-3.4],[-2.1],[3.6,-6,-1],[18.8,-79.3,77.2],[147.2],[3.6,9.6,7.1],[51.6,-37.9,27.3],[138.3],[-73,-7.1,68.1],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-63.3,52,54.1],[131.4],[86.1,-1.8,62.3],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //17. ER TEMPRATO

        const R = {"version":7,"data":[[0,2.66,0],[141.5,-86.7,89.2],[5.4,-28.6,64.8],[1.6,-2.7,-11],[-14,1.8,51.3],[3.6],[2.9,-5.8,70.1],[-21.4,12.9,56.7],[18.1],[-3.4,9.7,68.9],[24.7,-47.9,32.6],[83.3],[51.2,-28.2,47],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-22.6,52.6,-4],[118.4],[-74.2,46.3,44.4],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}

        //18. ER LUNA (dormiente)

        const S = {"version":7,"data":[[0,-27.8,0],[-87.3,4.4,-13.2],[7.1,10.1,-24.6],[-10.9,4.3,-18.4],[-2,-1.6,81.7],[99.8],[1.6,-6.7,24.6],[0.9,20.3,107.5],[104.5],[-9.3,-10.4,34.1],[-4.7,-18.4,34.1],[146.4],[-2.6,17.1,0.5],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[-23.6,53.3,54.8],[123.2],[-1.4,-44.5,6.5],[-90,70,75,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10],[0,0,10,0,10,0,10]]}



        function createScene() {
            // Create the scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color('gainsboro');
	        scene.fog = new THREE.Fog('gainsboro', 100, 600);

            
            // Create the camera
            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
            camera.position.z = 125;

            // Create the renderer
            renderer = new THREE.WebGLRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Add lights
           /*  const ambientLight = new THREE.AmbientLight(0x404040); // Ambient light
            scene.add(ambientLight); */

            light = new THREE.PointLight('white', 0.5);
            light.position.set(0, 100, 50);
            light.shadow.mapSize.width = 1024;
            light.shadow.mapSize.height = 1024;
            light.castShadow = true;
            scene.add(light, new THREE.AmbientLight('white', 0.5));

            /* const directionalLight = new THREE.DirectionalLight(0xffffff, 1); // Directional light
            directionalLight.position.set(1, 1, 1).normalize();
            scene.add(directionalLight); */

            /* var ground = new THREE.Mesh(
                new THREE.PlaneGeometry(1000, 1000),
                new THREE.MeshLambertMaterial(
                    {
                        color: 'antiquewhite',
                    })
            );
            ground.receiveShadow = true;
            ground.position.y = -29.5;
            ground.rotation.x = -Math.PI / 2;
            scene.add(ground); */


            // Add orbit controls for easier viewing
            controls = new THREE.OrbitControls(camera, renderer.domElement);
        }

        function createMannequin() {
            man = new Male();
            scene.add(man);
        }

        function init() {
            createScene();
            createMannequin();
            man.posture = A;
            animate();
           
        }

        function animate() {
            requestAnimationFrame(animate);

            // Render the scene
            renderer.render(scene, camera);
        }

        function blendPoses(postureA, postureB, alpha) {
            // Blend two postures based on alpha (0 to 1)
            const blendedPose = {
                version: postureA.version,
                data: []
            };

            // Interpolate each keyframe
            for (let i = 0; i < postureA.data.length; i++) {
                const frameA = postureA.data[i];
                const frameB = postureB.data[i];

                const interpolatedFrame = frameA.map((valueA, index) => {
                    return valueA + (frameB[index] - valueA) * alpha;
                });

                blendedPose.data.push(interpolatedFrame);
            }

            return blendedPose;
        }

        window.addEventListener('click', () => {
            const nextIndex = (postureIndex + 1) % 20; // Calculate the next posture index
            const currentPose = postures[postureIndex];
            const nextPose = postures[nextIndex];

            let alpha = 0; // Blend parameter

            function animateBlend() {
                alpha += 0.015; // Increment alpha (adjust speed of transition here)
                if (alpha <= 1) {
                    man.posture = blendPoses(currentPose, nextPose, alpha);
                    requestAnimationFrame(animateBlend);
                } else {
                    postureIndex = nextIndex; // Update posture index
                    man.posture = nextPose; // Set final pose
                }
            }

            animateBlend();
        });

        window.onload = () => {
            postures.push(A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S); // Store postures in an array
            init();
        };
    </script>
</body>

</html>